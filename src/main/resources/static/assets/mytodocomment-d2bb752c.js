
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{R as m,N as C,u as X,n as W,a as u,o as s,c as h,f as l,g as a,M as g,U as v,I as p,i as b,b as T,J as _,V as Y,q as R,Q as J,_ as Q,O as G}from"./index-04c83304.js";import{_ as H}from"./index-4ca463c3.js";const K=X(),I={data(){return{columnFields:[],commentsData:{list:[],currPage:1,pageSize:20,total:0,totalPage:0},showEditDialog:!1,dialogTitle:"",dialogType:"",batchBtnEnable:!1,search:{pageSize:20,pageIndex:1,sortBy:"createTime",sortType:"desc",queryParams:{}},departmentTree:{},listProjects:[],listUsers:[],selectedRoles:[],confirmResultItems:[],selectedRows:[],editDetail:{},editFieldRules:{name:[{required:!0,message:"用户姓名必填",trigger:"blur"}],account:[{required:!0,message:"用户账号必填",trigger:"blur"}]},languageType:"java"}},computed:{},mounted(){this.resetSearch(),this.getColumnFields(),this.loadUserList(),this.loadProjects(),this.loadConfirmResultItems(),this.loadDepartmentTree()},methods:{loadUserList(){m.get("server/user/getAllUserDetails").then(o=>{this.listUsers=o.data})},loadProjects(){m.get(`server/project/queryProjectInDept?deptId=${this.search.queryParams.departmentId}`).then(o=>{this.listProjects=o.data})},loadConfirmResultItems(){m.get("server/column/queryConfirmResultDictItems").then(o=>{this.confirmResultItems=o.data})},getColumnFields(){m.get("server/column/queryColumns").then(o=>{this.columnFields=o.data})},loadDepartmentTree(){m.get("server/dept/getDeptTree").then(o=>{this.departmentTree=o.data})},clickSearch(){m.post("/server/comment/queryComments",this.search).then(o=>{this.commentsData=o.data})},resetSearch(){this.search.queryParams={identifier:null,projectId:null,departmentId:null,realConfirmUser:null,assignConfirmUser:K.account,confirmResult:"unconfirmed"},this.clickSearch()},handleSizeChange(o){this.search.pageSize=o,this.clickSearch()},handleCurrentChange(o){this.search.pageIndex=o,this.clickSearch()},getSelectedRows(o){this.selectedRows=o,this.selectedRows&&this.selectedRows.length!==0?this.batchBtnEnable=!0:this.batchBtnEnable=!1},exportData(o){m.post("/server/comment/exportComments",this.search,{responseType:"blob"}).then(i=>{let y="review_comment_"+Date.now()+".xlsx",w=new Blob([i]);if("msSaveOrOpenBlob"in navigator)window.navigator.msSaveOrOpenBlob(w,y);else{let t=window.URL.createObjectURL(w),r=document.createElement("a");r.href=t,r.download=y,r.click(),window.URL.revokeObjectURL(t)}})},viewSingle(o){this.showEditDialog=!1,m.get(`server/comment/initViewReqBody?identifier=${o.identifier}`).then(i=>{this.editDetail=i.data,this.dialogTitle="评审意见详情",this.dialogType="VIEW",this.showEditDialog=!0,this.languageType=this.editDetail.codeType}).catch(i=>{C({type:"error",message:`编辑失败：${i}`})})},saveOperation(){this.$refs.editDetailForm.validate(o=>{if(!o)C({type:"error",message:"参数内容填写有误，请检查"});else{let i;if(this.dialogType==="CONFIRM")i="server/comment/confirmComment";else{C({type:"error",message:"请求操作类型不合法"});return}m.post(i,this.editDetail).then(y=>{y.code===0?(C({type:"success",message:"保存成功"}),this.showEditDialog=!1,this.clickSearch()):C({type:"error",message:`编辑失败：${y.message}`})})}})},cancelEditOperation(){this.showEditDialog=!1},cancelCreateOperation(){this.showEditDialog=!1},confirmSingle(o){this.showEditDialog=!1,m.get(`server/comment/initConfirmReqBody?identifier=${o.identifier}`).then(i=>{this.editDetail=i.data,this.dialogTitle="评审意见确认",this.dialogType="CONFIRM",this.showEditDialog=!0}).catch(i=>{C({type:"error",message:`编辑失败：${i}`})})}}};const Z={class:"button-group"},$={key:0},ee={style:{width:"100%","line-height":"30px",padding:"5px"}},le={class:"dialog-footer"};function te(o,i,y,w,t,r){const q=J,D=u("el-input"),c=u("el-form-item"),E=u("el-col"),V=u("el-option"),k=u("el-select"),M=u("el-tree-select"),L=u("el-row"),B=Q,P=u("el-icon"),f=u("el-button"),U=u("el-form"),j=H,S=G,F=u("el-table-column"),A=u("el-table"),N=u("el-pagination"),O=u("el-date-picker"),x=u("highlightjs"),z=u("el-dialog");return s(),h("div",null,[l(q,{title:"我的待办",content:"本页面展示所有等待您确认处理的评审意见信息，您可以点击查看或者执行确认。"}),l(S,{title:"搜索条件"},{default:a(()=>[l(j,null,{default:a(()=>[l(U,{model:t.search,size:"default","label-width":"120px"},{default:a(()=>[l(L,null,{default:a(()=>[l(E,{span:6},{default:a(()=>[l(c,{label:"唯一ID"},{default:a(()=>[l(D,{modelValue:t.search.queryParams.identifier,"onUpdate:modelValue":i[0]||(i[0]=e=>t.search.queryParams.identifier=e),placeholder:"输入评审意见唯一ID进行查询",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(E,{span:6},{default:a(()=>[l(c,{label:"检视人员"},{default:a(()=>[l(k,{modelValue:t.search.queryParams.commitUser,"onUpdate:modelValue":i[1]||(i[1]=e=>t.search.queryParams.commitUser=e),modelModifiers:{trim:!0},placeholder:"请输入姓名或账号查询",clearable:"",filterable:""},{default:a(()=>[(s(!0),h(g,null,v(t.listUsers,(e,n)=>(s(),p(V,{key:e.account,label:e.name,value:e.account},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(E,{span:6},{default:a(()=>[l(c,{label:"归属部门"},{default:a(()=>[l(M,{clearable:"",modelValue:t.search.queryParams.departmentId,"onUpdate:modelValue":i[2]||(i[2]=e=>t.search.queryParams.departmentId=e),data:t.departmentTree,"render-after-expand":!1,"check-strictly":"true",onChange:r.loadProjects},null,8,["modelValue","data","onChange"])]),_:1})]),_:1}),l(E,{span:6},{default:a(()=>[l(c,{label:"归属项目"},{default:a(()=>[l(k,{modelValue:t.search.queryParams.projectId,"onUpdate:modelValue":i[3]||(i[3]=e=>t.search.queryParams.projectId=e),modelModifiers:{trim:!0},placeholder:"请选择",clearable:"",filterable:""},{default:a(()=>[(s(!0),h(g,null,v(t.listProjects,(e,n)=>(s(),p(V,{key:e.id,label:e.projectName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,null,{default:a(()=>[l(f,{type:"primary",onClick:r.clickSearch},{icon:a(()=>[l(P,null,{default:a(()=>[l(B,{name:"ep:search"})]),_:1})]),default:a(()=>[b(" 查询 ")]),_:1},8,["onClick"]),l(f,{onClick:r.resetSearch},{default:a(()=>[b(" 重置 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),l(S,null,{default:a(()=>[T("div",Z,[l(f,{type:"default",onClick:r.exportData},{icon:a(()=>[l(P,null,{default:a(()=>[l(B,{name:"ep:download"})]),_:1})]),default:a(()=>[b(" 数据导出 ")]),_:1},8,["onClick"])]),l(A,{border:"","highlight-current-row":"",data:t.commentsData.list,height:"100%",onSelectionChange:r.getSelectedRows},{default:a(()=>[l(F,{type:"selection",width:"55"}),(s(!0),h(g,null,v(t.columnFields,(e,n)=>(s(),h(g,null,[e.showInWebTable?(s(),p(F,{key:e.columnCode,prop:e.columnCode,label:e.showName,width:e.webTableColumnWidth,index:n},null,8,["prop","label","width","index"])):_("",!0)],64))),256)),l(F,{fixed:"right",label:"操作",width:"200"},{default:a(e=>[l(f,{link:"",type:"primary",size:"small",onClick:n=>r.viewSingle(e.row)},{default:a(()=>[b(" 查看 ")]),_:2},1032,["onClick"]),l(f,{link:"",type:"primary",size:"small",onClick:n=>r.confirmSingle(e.row)},{default:a(()=>[b(" 确认 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"]),l(N,{class:"pageination-style",background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":t.commentsData.pageSize,total:t.commentsData.total,"current-page":t.commentsData.currPage,onSizeChange:r.handleSizeChange,onCurrentChange:r.handleCurrentChange},null,8,["page-size","total","current-page","onSizeChange","onCurrentChange"])]),_:1}),l(z,{modelValue:t.showEditDialog,"onUpdate:modelValue":i[4]||(i[4]=e=>t.showEditDialog=e),title:t.dialogTitle},Y({default:a(()=>[l(U,{ref:"editDetailForm",model:t.editDetail,size:"default","label-width":"120px",rules:t.editFieldRules},{default:a(()=>[(s(!0),h(g,null,v(t.editDetail.fieldModelList,(e,n)=>(s(),h(g,null,[e.show?(s(),h("div",$,[e.inputType=="TEXT"?(s(),p(c,{key:0,label:e.showName},{default:a(()=>[l(D,{modelValue:t.editDetail.fieldModelList[n].valuePair.value,"onUpdate:modelValue":d=>t.editDetail.fieldModelList[n].valuePair.value=d,disabled:e.editable===!1},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])):_("",!0),e.inputType=="COMBO_BOX"?(s(),p(c,{key:1,label:e.showName},{default:a(()=>[l(k,{modelValue:t.editDetail.fieldModelList[n].valuePair,"onUpdate:modelValue":d=>t.editDetail.fieldModelList[n].valuePair=d,disabled:e.editable===!1,filterable:""},{default:a(()=>[(s(!0),h(g,null,v(e.enumValues,d=>(s(),p(V,{label:d.showName,value:d},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])):_("",!0),e.inputType=="DATE"?(s(),p(c,{key:2,label:e.showName},{default:a(()=>[l(O,{disabled:e.editable===!1,modelValue:t.editDetail.fieldModelList[n].valuePair.value,"onUpdate:modelValue":d=>t.editDetail.fieldModelList[n].valuePair.value=d,type:"date","value-format":"YYYY-MM-DD",placeholder:"点击选择日期"},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):_("",!0),e.inputType=="TEXTAREA"&&e.code=="content"&&e.editable===!1?(s(),p(c,{key:3,label:e.showName},{default:a(()=>[T("div",ee,[l(x,{language:t.languageType,code:t.editDetail.fieldModelList[n].valuePair.value},null,8,["language","code"])])]),_:2},1032,["label"])):_("",!0),e.inputType=="TEXTAREA"&&e.code=="content"&&e.editable===!0?(s(),p(c,{key:4,label:e.showName},{default:a(()=>[l(D,{modelValue:t.editDetail.fieldModelList[n].valuePair.value,"onUpdate:modelValue":d=>t.editDetail.fieldModelList[n].valuePair.value=d,rows:5,disabled:e.editable===!1,type:"textarea"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])):_("",!0),e.inputType=="TEXTAREA"&&e.code!="content"?(s(),p(c,{key:5,label:e.showName},{default:a(()=>[l(D,{modelValue:t.editDetail.fieldModelList[n].valuePair.value,"onUpdate:modelValue":d=>t.editDetail.fieldModelList[n].valuePair.value=d,rows:5,disabled:e.editable===!1,type:"textarea"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])):_("",!0)])):_("",!0)],64))),256))]),_:1},8,["model","rules"])]),_:2},[t.dialogType!=="VIEW"?{name:"footer",fn:a(()=>[T("span",le,[l(f,{onClick:r.cancelEditOperation},{default:a(()=>[b(" 取消 ")]),_:1},8,["onClick"]),l(f,{type:"primary",onClick:r.saveOperation},{default:a(()=>[b(" 保存 ")]),_:1},8,["onClick"])])]),key:"0"}:void 0]),1032,["modelValue","title"])])}typeof R=="function"&&R(I);const ie=W(I,[["render",te],["__scopeId","data-v-8003f09d"]]);export{ie as default};
//# sourceMappingURL=mytodocomment-d2bb752c.js.map
