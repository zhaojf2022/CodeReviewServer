{"version":3,"file":"index-4f83ef7b.js","sources":["../../src/utils/composables/useMainPage.ts","../../src/layouts/index.vue"],"sourcesContent":["import router from '@/router'\r\n\r\nexport default function useMainPage() {\r\n  function reload() {\r\n    router.push({\r\n      name: 'reload',\r\n    })\r\n  }\r\n\r\n  return {\r\n    reload,\r\n  }\r\n}\r\n","<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nexport default defineComponent({\n  name: 'Layout',\n})\n</script>\n<script lang=\"ts\" setup name=\"Layout\">\nimport hotkeys from 'hotkeys-js'\nimport LinkView from './components/views/link.vue'\nimport Header from './components/Header/index.vue'\nimport MainSidebar from './components/MainSidebar/index.vue'\nimport SubSidebar from './components/SubSidebar/index.vue'\nimport Topbar from './components/Topbar/index.vue'\nimport Search from './components/Search/index.vue'\nimport AppSetting from './components/AppSetting/index.vue'\nimport useSettingsStore from '@/store/modules/settings'\nimport useKeepAliveStore from '@/store/modules/keepAlive'\nimport useMenuStore from '@/store/modules/menu'\n\nconst routeInfo = useRoute()\n\nconst settingsStore = useSettingsStore()\nconst keepAliveStore = useKeepAliveStore()\nconst menuStore = useMenuStore()\n\nconst isLink = computed(() => !!routeInfo.meta.link)\n\nwatch(() => settingsStore.settings.menu.subMenuCollapse, (val) => {\n  if (settingsStore.mode === 'mobile') {\n    if (!val) {\n      document.body.classList.add('hidden')\n    }\n    else {\n      document.body.classList.remove('hidden')\n    }\n  }\n})\n\nwatch(() => routeInfo.path, () => {\n  if (settingsStore.mode === 'mobile') {\n    settingsStore.$patch((state) => {\n      state.settings.menu.subMenuCollapse = true\n    })\n  }\n})\n\nonMounted(() => {\n  hotkeys('f5', (e) => {\n    if (settingsStore.settings.toolbar.enablePageReload) {\n      e.preventDefault()\n      useMainPage().reload()\n    }\n  })\n  hotkeys('alt+`', (e) => {\n    if (settingsStore.settings.menu.enableHotkeys) {\n      e.preventDefault()\n      useMenu().switchTo(menuStore.actived + 1 < menuStore.allMenus.length ? menuStore.actived + 1 : 0)\n    }\n  })\n})\nonUnmounted(() => {\n  hotkeys.unbind('f5')\n  hotkeys.unbind('alt+`')\n})\n</script>\n\n<template>\n  <div class=\"layout\">\n    <div id=\"app-main\">\n      <Header />\n      <div class=\"wrapper\">\n        <div class=\"sidebar-container\" :class=\"{ show: settingsStore.mode === 'mobile' && !settingsStore.settings.menu.subMenuCollapse }\">\n          <MainSidebar />\n          <SubSidebar />\n        </div>\n        <div class=\"sidebar-mask\" :class=\"{ show: settingsStore.mode === 'mobile' && !settingsStore.settings.menu.subMenuCollapse }\" @click=\"settingsStore.toggleSidebarCollapse()\" />\n        <div class=\"main-container\" :style=\"{ 'padding-bottom': $route.meta.paddingBottom } as any\">\n          <Topbar v-if=\"!(settingsStore.settings.menu.menuMode === 'head' && !settingsStore.settings.menu.enableSubMenuCollapseButton && !settingsStore.settings.breadcrumb.enable)\" />\n          <div class=\"main\">\n            <router-view v-slot=\"{ Component, route }\">\n              <transition name=\"main\" mode=\"out-in\" appear>\n                <keep-alive :include=\"keepAliveStore.list\">\n                  <component :is=\"Component\" v-show=\"!isLink\" :key=\"route.fullPath\" />\n                </keep-alive>\n              </transition>\n            </router-view>\n            <LinkView v-if=\"isLink\" />\n          </div>\n          <Copyright />\n        </div>\n      </div>\n      <el-backtop :right=\"20\" :bottom=\"20\" title=\"回到顶部\" />\n    </div>\n    <Search />\n    <AppSetting />\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n[data-mode=\"mobile\"] {\n  .sidebar-container {\n    transform: translateX(calc((var(--g-main-sidebar-width) + var(--g-sub-sidebar-width)) * -1));\n\n    &.show {\n      transform: translateX(0);\n    }\n  }\n\n  .main-container {\n    margin-left: 0 !important;\n  }\n\n  &[data-menu-mode=\"single\"] {\n    .sidebar-container {\n      transform: translateX(calc(var(--g-sub-sidebar-width) * -1));\n\n      &.show {\n        transform: translateX(0);\n      }\n    }\n  }\n}\n\n.layout {\n  height: 100%;\n}\n\n#app-main {\n  width: 100%;\n  height: 100%;\n  margin: 0 auto;\n  transition: all 0.2s;\n}\n\n.wrapper {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  box-shadow: -1px 0 0 0 var(--g-box-shadow-color);\n  transition: padding-top 0.3s;\n\n  .sidebar-container {\n    position: fixed;\n    z-index: 1010;\n    top: 0;\n    bottom: 0;\n    display: flex;\n    transition: transform 0.3s, top 0.3s;\n    width: calc(var(--g-main-sidebar-actual-width) + var(--g-sub-sidebar-actual-width));\n  }\n\n  .sidebar-mask {\n    position: fixed;\n    z-index: 1000;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-image: radial-gradient(transparent 1px, rgb(0 0 0 / 30%) 1px);\n    background-size: 4px 4px;\n    backdrop-filter: saturate(50%) blur(4px);\n    transition: all 0.2s;\n    opacity: 0;\n    visibility: hidden;\n\n    &.show {\n      opacity: 1;\n      visibility: visible;\n    }\n  }\n\n  .main-sidebar-container:not(.main-sidebar-leave-active) + .sub-sidebar-container {\n    left: var(--g-main-sidebar-width);\n  }\n\n  .main-container {\n    display: flex;\n    flex-direction: column;\n    min-height: 100%;\n    margin-left: calc(var(--g-main-sidebar-actual-width) + var(--g-sub-sidebar-actual-width));\n    background-color: var(--g-main-bg);\n    transition: margin-left 0.3s, background-color 0.3s;\n\n    .topbar-container {\n      top: 0;\n      z-index: 998;\n    }\n\n    .main {\n      height: 100%;\n      flex: auto;\n      position: relative;\n      overflow: hidden;\n      transition: 0.3s;\n    }\n\n    .topbar-container + .main {\n      margin: var(--g-topbar-height) 0 0;\n    }\n  }\n}\n\nheader:not(.header-leave-active) + .wrapper {\n  padding-top: var(--g-header-height);\n\n  .sidebar-container {\n    top: var(--g-header-height);\n\n    :deep(.sidebar-logo) {\n      display: none;\n    }\n\n    :deep(.el-menu) {\n      padding-top: 0;\n    }\n  }\n\n  .main-container {\n    .topbar-container {\n      top: var(--g-header-height);\n\n      :deep(.tools) {\n        display: none;\n      }\n    }\n  }\n}\n\n// 主内容区动画\n.main-enter-active {\n  transition: 0.2s;\n}\n\n.main-leave-active {\n  transition: 0.15s;\n}\n\n.main-enter-from {\n  opacity: 0;\n  margin-left: -20px;\n}\n\n.main-leave-to {\n  opacity: 0;\n  margin-left: 20px;\n}\n</style>\n"],"names":["useMainPage","reload","router","__default__","defineComponent","routeInfo","useRoute","settingsStore","useSettingsStore","keepAliveStore","useKeepAliveStore","menuStore","useMenuStore","isLink","computed","watch","val","state","onMounted","hotkeys","e","useMenu","onUnmounted"],"mappings":"qnBAEA,SAAwBA,GAAc,CACpC,SAASC,GAAS,CAChBC,EAAO,KAAK,CACV,KAAM,QAAA,CACP,CACH,CAEO,MAAA,CACL,OAAAD,CAAA,CAEJ,kFCVAE,GAAAC,EAAA,CAA+B,KAAA,QAE/B,CAAA,uBAeA,MAAAC,EAAAC,IAEAC,EAAAC,IACAC,EAAAC,IACAC,EAAAC,IAEAC,EAAAC,EAAA,IAAA,CAAA,CAAAT,EAAA,KAAA,IAAA,EAEA,OAAAU,EAAA,IAAAR,EAAA,SAAA,KAAA,gBAAAS,GAAA,CACET,EAAA,OAAA,WACES,EAIE,SAAA,KAAA,UAAA,OAAA,QAAA,EAHA,SAAA,KAAA,UAAA,IAAA,QAAA,EAKJ,CAAA,EAGFD,EAAA,IAAAV,EAAA,KAAA,IAAA,CACEE,EAAA,OAAA,UACEA,EAAA,OAAAU,GAAA,CACEA,EAAA,SAAA,KAAA,gBAAA,EAAsC,CAAA,CAE1C,CAAA,EAGFC,EAAA,IAAA,CACEC,EAAA,KAAAC,GAAA,CACEb,EAAA,SAAA,QAAA,mBACEa,EAAA,eAAA,EACApB,EAAA,EAAA,SACF,CAAA,EAEFmB,EAAA,QAAAC,GAAA,CACEb,EAAA,SAAA,KAAA,gBACEa,EAAA,eAAA,EACAC,EAAA,EAAA,SAAAV,EAAA,QAAA,EAAAA,EAAA,SAAA,OAAAA,EAAA,QAAA,EAAA,CAAA,EACF,CAAA,CACD,CAAA,EAEHW,EAAA,IAAA,CACEH,EAAA,OAAA,IAAA,EACAA,EAAA,OAAA,OAAA,CAAsB,CAAA"}