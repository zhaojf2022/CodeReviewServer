{"version":3,"file":"login-578e1535.js","sources":["../../src/views/login.vue"],"sourcesContent":["<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nexport default defineComponent({\n  name: 'Login',\n})\n</script>\n<route lang=\"yaml\">\nmeta:\n  title: 登录\n  constant: true\n  layout: false\n</route>\n\n<script lang=\"ts\" setup name=\"Login\">\nimport type { FormInstance, FormRules } from 'element-plus'\nimport { ElMessage } from 'element-plus'\nimport useUserStore from '@/store/modules/user'\n\nconst route = useRoute()\nconst router = useRouter()\n\nconst userStore = useUserStore()\n\nconst banner = new URL('../assets/images/login-banner.png', import.meta.url).href\nconst title = import.meta.env.VITE_APP_TITLE\n\n// 表单类型，login 登录，reset 重置密码\nconst formType = ref('login')\nconst loading = ref(false)\nconst redirect = ref(route.query.redirect?.toString() ?? '/')\n\n// 登录\nconst loginFormRef = ref<FormInstance>()\nconst loginForm = ref({\n  account: localStorage.login_account || '',\n  password: '',\n  remember: !!localStorage.login_account,\n})\nconst loginRules = ref<FormRules>({\n  account: [\n    { required: true, trigger: 'blur', message: '请输入用户名' },\n  ],\n  password: [\n    { required: true, trigger: 'blur', message: '请输入密码' },\n    { min: 6, max: 18, trigger: 'blur', message: '密码长度为6到18位' },\n  ],\n})\nfunction handleLogin() {\n  loginFormRef.value && loginFormRef.value.validate((valid) => {\n    if (valid) {\n      loading.value = true\n      userStore.login(loginForm.value).then(() => {\n        loading.value = false\n        if (loginForm.value.remember) {\n          localStorage.setItem('login_account', loginForm.value.account)\n        }\n        else {\n          localStorage.removeItem('login_account')\n        }\n        router.push(redirect.value)\n      }).catch(() => {\n        loading.value = false\n      })\n    }\n  })\n}\n\n// 注册\nconst registerFormRef = ref<FormInstance>()\nconst registerForm = ref({\n  account: '',\n  captcha: '',\n  password: '',\n  checkPassword: '',\n})\nconst registerRules = ref<FormRules>({\n  account: [\n    { required: true, trigger: 'blur', message: '请输入用户名' },\n  ],\n  captcha: [\n    { required: true, trigger: 'blur', message: '请输入验证码' },\n  ],\n  password: [\n    { required: true, trigger: 'blur', message: '请输入密码' },\n    { min: 6, max: 18, trigger: 'blur', message: '密码长度为6到18位' },\n  ],\n  checkPassword: [\n    { required: true, trigger: 'blur', message: '请再次输入密码' },\n    {\n      validator: (rule, value, callback) => {\n        if (value !== registerForm.value.password) {\n          callback(new Error('两次输入的密码不一致'))\n        }\n        else {\n          callback()\n        }\n      },\n    },\n  ],\n})\n\n// 重置密码\nconst resetFormRef = ref<FormInstance>()\nconst resetForm = ref({\n  account: localStorage.login_account || '',\n  captcha: '',\n  newPassword: '',\n})\nconst resetRules = ref<FormRules>({\n  account: [\n    { required: true, trigger: 'blur', message: '请输入用户名' },\n  ],\n  captcha: [\n    { required: true, trigger: 'blur', message: '请输入验证码' },\n  ],\n  newPassword: [\n    { required: true, trigger: 'blur', message: '请输入新密码' },\n    { min: 6, max: 18, trigger: 'blur', message: '密码长度为6到18位' },\n  ],\n})\n\n</script>\n\n<template>\n  <div>\n    <div class=\"bg-banner\" />\n    <div id=\"login-box\">\n      <div class=\"login-banner\">\n        <div class=\"logo\" />\n        <img :src=\"banner\" class=\"banner\">\n      </div>\n      <el-form v-show=\"formType === 'login'\" ref=\"loginFormRef\" :model=\"loginForm\" :rules=\"loginRules\" class=\"login-form\" autocomplete=\"on\">\n        <div class=\"title-container\">\n          <h3 class=\"title\">\n            欢迎来到 {{ title }} ! 👋🏻\n          </h3>\n        </div>\n        <div>\n          <el-form-item prop=\"account\">\n            <el-input v-model=\"loginForm.account\" placeholder=\"用户名\" text tabindex=\"1\" autocomplete=\"on\">\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:user\" />\n                </el-icon>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"password\">\n            <el-input v-model=\"loginForm.password\" type=\"password\" placeholder=\"密码\" tabindex=\"2\" autocomplete=\"on\" show-password @keyup.enter=\"handleLogin\">\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:lock\" />\n                </el-icon>\n              </template>\n            </el-input>\n          </el-form-item>\n        </div>\n        <div class=\"flex-bar\">\n          <el-checkbox v-model=\"loginForm.remember\">\n            记住我\n          </el-checkbox>\n\n        </div>\n        <el-button :loading=\"loading\" type=\"primary\" size=\"large\" style=\"width: 100%;\" @click.prevent=\"handleLogin\">\n          登录\n        </el-button>\n\n      </el-form>\n      <el-form v-show=\"formType === 'register'\" ref=\"registerFormRef\" :model=\"registerForm\" :rules=\"registerRules\" class=\"login-form\" auto-complete=\"on\">\n        <div class=\"title-container\">\n          <h3 class=\"title\">\n            探索从这里开始! 🚀\n          </h3>\n        </div>\n        <div>\n          <el-form-item prop=\"account\">\n            <el-input v-model=\"registerForm.account\" placeholder=\"用户名\" tabindex=\"1\" autocomplete=\"on\">\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:user\" />\n                </el-icon>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"captcha\">\n            <el-input ref=\"captcha\" v-model=\"registerForm.captcha\" placeholder=\"验证码\" tabindex=\"2\" autocomplete=\"on\">\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:key\" />\n                </el-icon>\n              </template>\n              <template #append>\n                <el-button>发送验证码</el-button>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"password\">\n            <el-input v-model=\"registerForm.password\" type=\"password\" placeholder=\"密码\" tabindex=\"3\" autocomplete=\"on\" show-password>\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:lock\" />\n                </el-icon>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"checkPassword\">\n            <el-input v-model=\"registerForm.checkPassword\" type=\"password\" placeholder=\"确认密码\" tabindex=\"4\" autocomplete=\"on\" show-password>\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:lock\" />\n                </el-icon>\n              </template>\n            </el-input>\n          </el-form-item>\n        </div>\n\n      </el-form>\n      <el-form v-show=\"formType === 'reset'\" ref=\"resetFormRef\" :model=\"resetForm\" :rules=\"resetRules\" class=\"login-form\" auto-complete=\"on\">\n        <div class=\"title-container\">\n          <h3 class=\"title\">\n            忘记密码了? 🔒\n          </h3>\n        </div>\n        <div>\n          <el-form-item prop=\"account\">\n            <el-input v-model=\"resetForm.account\" placeholder=\"用户名\" tabindex=\"1\" autocomplete=\"on\">\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:user\" />\n                </el-icon>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"captcha\">\n            <el-input ref=\"captcha\" v-model=\"resetForm.captcha\" placeholder=\"验证码\" tabindex=\"2\" autocomplete=\"on\">\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:key\" />\n                </el-icon>\n              </template>\n              <template #append>\n                <el-button>发送验证码</el-button>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"newPassword\">\n            <el-input v-model=\"resetForm.newPassword\" type=\"password\" placeholder=\"新密码\" tabindex=\"3\" autocomplete=\"on\" show-password>\n              <template #prefix>\n                <el-icon>\n                  <svg-icon name=\"ep:lock\" />\n                </el-icon>\n              </template>\n            </el-input>\n          </el-form-item>\n        </div>\n        <div class=\"sub-link\">\n          <el-link type=\"primary\" :underline=\"false\" @click=\"formType = 'login'\">\n            返回登录\n          </el-link>\n        </div>\n      </el-form>\n    </div>\n    <Copyright />\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n[data-mode=\"mobile\"] {\n  #login-box {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    top: inherit;\n    left: inherit;\n    transform: translateX(0) translateY(0);\n    flex-direction: column;\n    justify-content: start;\n    border-radius: 0;\n    box-shadow: none;\n\n    .login-banner {\n      width: 100%;\n      padding: 20px 0;\n\n      .banner {\n        position: relative;\n        right: inherit;\n        width: 100%;\n        max-width: 375px;\n        margin: 0 auto;\n        display: inherit;\n        top: inherit;\n        transform: translateY(0);\n      }\n    }\n\n    .login-form {\n      width: 100%;\n      min-height: auto;\n      padding: 30px;\n    }\n  }\n\n  .copyright {\n    position: relative;\n    bottom: 0;\n    padding-bottom: 10px;\n  }\n}\n\n:deep(input[type=\"password\"]::-ms-reveal) {\n  display: none;\n}\n\n.bg-banner {\n  position: fixed;\n  z-index: 0;\n  width: 100%;\n  height: 100%;\n  background: radial-gradient(circle at center, var(--el-fill-color-lighter), var(--el-bg-color-page));\n}\n\n#login-box {\n  display: flex;\n  justify-content: space-between;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translateX(-50%) translateY(-50%);\n  background-color: var(--el-bg-color);\n  border-radius: 10px;\n  overflow: hidden;\n  box-shadow: var(--el-box-shadow);\n\n  .login-banner {\n    position: relative;\n    width: 450px;\n    background-color: var(--el-fill-color-light);\n    overflow: hidden;\n\n    .banner {\n      width: 100%;\n\n      @include position-center(y);\n    }\n\n    .logo {\n      position: absolute;\n      top: 20px;\n      left: 20px;\n      width: 60px;\n      height: 60px;\n      border-radius: 4px;\n      background: url(\"../assets/images/logo.png\") no-repeat;\n      background-size: contain;\n      box-shadow: var(--el-box-shadow-light);\n    }\n  }\n\n  .login-form {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    min-height: 500px;\n    width: 500px;\n    padding: 50px;\n    overflow: hidden;\n\n    .title-container {\n      position: relative;\n\n      .title {\n        font-size: 1.3em;\n        color: var(--el-text-color-primary);\n        margin: 0 auto 30px;\n        font-weight: bold;\n      }\n    }\n  }\n\n  .el-form-item {\n    margin-bottom: 24px;\n\n    :deep(.el-input) {\n      height: 48px;\n      line-height: inherit;\n      width: 100%;\n\n      input {\n        height: 48px;\n      }\n\n      .el-input__prefix,\n      .el-input__suffix {\n        display: flex;\n        align-items: center;\n      }\n\n      .el-input__prefix {\n        left: 10px;\n      }\n\n      .el-input__suffix {\n        right: 10px;\n      }\n    }\n  }\n\n  .flex-bar {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 20px;\n  }\n\n  .sub-link {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-top: 20px;\n    font-size: 14px;\n    color: var(--el-text-color-secondary);\n\n    .text {\n      margin-right: 10px;\n    }\n  }\n}\n\n.copyright {\n  position: absolute;\n  bottom: 30px;\n  width: 100%;\n  margin: 0;\n}\n</style>\n"],"names":["__default__","defineComponent","route","useRoute","router","useRouter","userStore","useUserStore","banner","title","formType","ref","loading","redirect","_a","loginFormRef","loginForm","loginRules","handleLogin","valid","registerFormRef","registerForm","registerRules","rule","value","callback","resetFormRef","resetForm","resetRules"],"mappings":"yrBAEAA,GAAAC,EAAA,CAA+B,KAAA,OAE/B,CAAA,4BAcA,MAAAC,EAAAC,IACAC,EAAAC,KAEAC,EAAAC,IAEAC,EAAA,IAAA,IAAA,GAAA,IAAA,IAAA,4BAAA,YAAA,GAAA,EAAA,KAAA,KAAA,QAAA,EAAA,KACAC,EAAA,eAGAC,EAAAC,EAAA,OAAA,EACAC,EAAAD,EAAA,EAAA,EACAE,EAAAF,IAAAG,EAAAZ,EAAA,MAAA,WAAA,YAAAY,EAAA,aAAA,GAAA,EAGAC,EAAAJ,IACAK,EAAAL,EAAA,CAAsB,QAAA,aAAA,eAAA,GACmB,SAAA,GAC7B,SAAA,CAAA,CAAA,aAAA,aACe,CAAA,EAE3BM,EAAAN,EAAA,CAAkC,QAAA,CACvB,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,QAAA,CAC8C,EACvD,SAAA,CACU,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,OAAA,EAC4C,CAAA,IAAA,EAAA,IAAA,GAAA,QAAA,OAAA,QAAA,YAAA,CACM,CAC5D,CAAA,EAEF,SAAAO,GAAA,CACEH,EAAA,OAAAA,EAAA,MAAA,SAAAI,GAAA,CACEA,IACEP,EAAA,MAAA,GACAN,EAAA,MAAAU,EAAA,KAAA,EAAA,KAAA,IAAA,CACEJ,EAAA,MAAA,GACAI,EAAA,MAAA,SACE,aAAA,QAAA,gBAAAA,EAAA,MAAA,OAAA,EAGA,aAAA,WAAA,eAAA,EAEFZ,EAAA,KAAAS,EAAA,KAAA,CAA0B,CAAA,EAAA,MAAA,IAAA,CAE1BD,EAAA,MAAA,EAAgB,CAAA,EAEpB,CAAA,CACD,CAIH,MAAAQ,EAAAT,IACAU,EAAAV,EAAA,CAAyB,QAAA,GACd,QAAA,GACA,SAAA,GACC,cAAA,EACK,CAAA,EAEjBW,EAAAX,EAAA,CAAqC,QAAA,CAC1B,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,QAAA,CAC8C,EACvD,QAAA,CACS,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,QAAA,CAC8C,EACvD,SAAA,CACU,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,OAAA,EAC4C,CAAA,IAAA,EAAA,IAAA,GAAA,QAAA,OAAA,QAAA,YAAA,CACM,EAC5D,cAAA,CACe,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,SAAA,EACyC,CACtD,UAAA,CAAAY,EAAAC,EAAAC,IAAA,CAEID,IAAAH,EAAA,MAAA,SACEI,EAAA,IAAA,MAAA,YAAA,CAAA,EAGAA,GACF,CACF,CACF,CACF,CAAA,EAIFC,EAAAf,IACAgB,EAAAhB,EAAA,CAAsB,QAAA,aAAA,eAAA,GACmB,QAAA,GAC9B,YAAA,EACI,CAAA,EAEfiB,EAAAjB,EAAA,CAAkC,QAAA,CACvB,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,QAAA,CAC8C,EACvD,QAAA,CACS,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,QAAA,CAC8C,EACvD,YAAA,CACa,CAAA,SAAA,GAAA,QAAA,OAAA,QAAA,QAAA,EAC0C,CAAA,IAAA,EAAA,IAAA,GAAA,QAAA,OAAA,QAAA,YAAA,CACK,CAC5D,CAAA"}