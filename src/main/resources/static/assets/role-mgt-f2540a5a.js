
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{R as p,S as E,N as n,n as A,a as s,o as V,c as S,f as e,g as t,b as C,i as m,q as w,Q as T,_ as N,O as I}from"./index-04c83304.js";const b={data(){return{showEditDialog:!1,showManageDialog:!1,batchBtnEnable:!1,dataList:[],itemList:[],dialogType:"",manageCollectionCode:0,editItemDetail:{},showEditItemDialog:!1,itemDialogType:"",selectedRows:[],editDetail:{},editFieldRules:{roleCode:[{required:!0,message:"角色编码必填",trigger:"blur"}],roleName:[{required:!0,message:"角色名称必填",trigger:"blur"}]}}},computed:{},mounted(){this.clickSearch()},methods:{loadListData(){p.get("server/role/getRoles").then(i=>{this.dataList=i.data})},clickSearch(){this.loadListData()},getSelectedRows(i){this.selectedRows=i,this.selectedRows&&this.selectedRows.length!==0?this.batchBtnEnable=!0:this.batchBtnEnable=!1},deleteSelection(i){E.confirm("确定要删除所选角色吗？此操作不可恢复！","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=[];for(let u=0;u<this.selectedRows.length;u++){const f=this.selectedRows[u];l.push(f.id)}p.get(`server/role/deleteRoles?roleIds=${l}`).then(u=>{u.code===0?n({type:"success",message:"删除成功"}):n({type:"error",message:`删除失败：${u.message}`}),this.clickSearch()})}).catch(()=>{})},deleteSingle(i){E.confirm("确定要删除此角色吗？此操作不可恢复！","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{p.get(`server/role/deleteRole?roleId=${i.id}`).then(l=>{l.code===0?n({type:"success",message:"删除成功"}):n({type:"error",message:`删除失败：${l.message}`}),this.clickSearch()})}).catch(()=>{})},editSingle(i){p.get(`server/role/getRoleById?roleId=${i.id}`).then(l=>{this.editDetail={roleCode:l.data.roleCode,roleName:l.data.roleName,roleDesc:l.data.roleDesc,canAccessPage:l.data.canAccessPage,id:l.data.id},this.dialogType="EDIT",this.showEditDialog=!0}).catch(l=>{n({type:"error",message:`编辑失败：${l}`})})},saveEditOperation(){this.$refs.editDetailForm.validate(i=>{if(!i)n({type:"error",message:"参数内容填写有误，请检查"});else{let l=`server/role/modifyRole?roleId=${this.editDetail.id}`;this.dialogType==="CREATE"&&(l="server/role/addRole"),p.post(l,this.editDetail).then(u=>{u.code===0?(n({type:"success",message:"保存成功"}),this.showEditDialog=!1,this.clickSearch()):n({type:"error",message:`编辑失败：${u.message}`})})}})},cancelEditOperation(){this.showEditDialog=!1},create(){this.editDetail={roleCode:"",roleName:"",roleDesc:"",canAccessPage:""},this.dialogType="CREATE",this.showEditDialog=!0},cancelCreateOperation(){this.showEditDialog=!1}}};const L={class:"button-group"},P={class:"dialog-footer"};function O(i,l,u,f,o,d){const B=T,D=N,F=s("el-icon"),c=s("el-button"),r=s("el-table-column"),y=s("el-table"),x=I,g=s("el-input"),_=s("el-form-item"),h=s("el-col"),k=s("el-form"),R=s("el-dialog");return V(),S("div",null,[e(B,{title:"角色管理",content:"本页面提供对用户角色的维护能力。"}),e(x,null,{default:t(()=>[C("div",L,[e(c,{type:"primary",onClick:d.create},{icon:t(()=>[e(F,null,{default:t(()=>[e(D,{name:"ep:circle-plus"})]),_:1})]),default:t(()=>[m(" 新建 ")]),_:1},8,["onClick"]),e(c,{type:"danger",disabled:!o.batchBtnEnable,onClick:d.deleteSelection},{icon:t(()=>[e(F,null,{default:t(()=>[e(D,{name:"ep:delete"})]),_:1})]),default:t(()=>[m(" 删除所选 ")]),_:1},8,["disabled","onClick"])]),e(y,{border:"","highlight-current-row":"",data:o.dataList,height:"100%",onSelectionChange:d.getSelectedRows},{default:t(()=>[e(r,{type:"selection",width:"55"}),e(r,{fixed:"",prop:"id",label:"ID",width:"100"}),e(r,{fixed:"",prop:"roleCode",label:"角色编码",width:"140"}),e(r,{fixed:"",prop:"roleName",label:"角色名称",width:"140"}),e(r,{fixed:"",prop:"canAccessPage",label:"可访问界面",width:"400"}),e(r,{prop:"roleDesc",label:"描述说明"}),e(r,{fixed:"right",label:"操作",width:"200"},{default:t(a=>[e(c,{link:"",type:"primary",size:"small",onClick:v=>d.editSingle(a.row)},{default:t(()=>[m(" 编辑 ")]),_:2},1032,["onClick"]),e(c,{link:"",type:"danger",size:"small",onClick:v=>d.deleteSingle(a.row)},{default:t(()=>[m(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])]),_:1}),e(R,{modelValue:o.showEditDialog,"onUpdate:modelValue":l[4]||(l[4]=a=>o.showEditDialog=a),title:o.dialogType==="CREATE"?"创建角色":"编辑角色"},{footer:t(()=>[C("span",P,[e(c,{onClick:d.cancelEditOperation},{default:t(()=>[m(" 取消 ")]),_:1},8,["onClick"]),e(c,{type:"primary",onClick:d.saveEditOperation},{default:t(()=>[m(" 保存 ")]),_:1},8,["onClick"])])]),default:t(()=>[e(k,{ref:"editDetailForm",model:o.editDetail,size:"default","label-width":"120px",rules:o.editFieldRules},{default:t(()=>[e(h,{span:18},{default:t(()=>[e(_,{label:"角色编码",prop:"roleCode",rules:o.editFieldRules.roleCode},{default:t(()=>[e(g,{modelValue:o.editDetail.roleCode,"onUpdate:modelValue":l[0]||(l[0]=a=>o.editDetail.roleCode=a),placeholder:"输入角色编码",maxlength:"64","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(h,{span:18},{default:t(()=>[e(_,{label:"角色名称",prop:"roleName",rules:o.editFieldRules.roleName},{default:t(()=>[e(g,{modelValue:o.editDetail.roleName,"onUpdate:modelValue":l[1]||(l[1]=a=>o.editDetail.roleName=a),placeholder:"输入角色名称",maxlength:"64","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(h,{span:18},{default:t(()=>[e(_,{label:"可访问界面",prop:"canAccessPage"},{default:t(()=>[e(g,{modelValue:o.editDetail.canAccessPage,"onUpdate:modelValue":l[2]||(l[2]=a=>o.editDetail.canAccessPage=a),placeholder:"输入可访问界面，多个之间逗号分隔，输入ALL表示允许访问全部界面",maxlength:"255","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{span:18},{default:t(()=>[e(_,{label:"角色描述"},{default:t(()=>[e(g,{modelValue:o.editDetail.roleDesc,"onUpdate:modelValue":l[3]||(l[3]=a=>o.editDetail.roleDesc=a),type:"textarea",rows:3,placeholder:"输入简要描述信息",clearable:"",maxlength:"256","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}typeof w=="function"&&w(b);const M=A(b,[["render",O],["__scopeId","data-v-4be64ae5"]]);export{M as default};
//# sourceMappingURL=role-mgt-f2540a5a.js.map
